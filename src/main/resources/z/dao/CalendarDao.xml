<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="z.dao.CalendarDao">

	<resultMap type="calendar" id="calendar-map">
		<result column="mnum"   	 property="memberNo" />
		<result column="mtnum" 	 	 property="meetingNo" />
		<result column="cdate"		 property="calendarDate" />
		<result column="ctime"  	 property="calendarTime" />
	</resultMap>

	<select id="getDateDuplication" parameterType="int" resultMap="calendar-map">
		select cal.cdate from cal where mtnum=#{value} group by cdate having count(*) >= (select count(*) from cal where mtnum=#{value} group by cdate order by count(*) desc limit 1);
	</select>

	<select id="getSelectedDateInfo" parameterType="int" resultMap="calendar-map">
		select cal.mtnum, cal.mnum, cal.cdate, cal.ctime from cal where cal.mtnum=#{value};
	</select>

	<delete id="deleteCal" parameterType="int">
		delete from cal where mtnum=#{value};
	</delete>

	<insert id="insertCal" parameterType="calendar">
		insert into cal (mnum, mtnum, cdate, ctime) values (#{memberNo}, #{meetingNo}, #{calendarDate}, #{calendarTime});
	</insert>

</mapper>